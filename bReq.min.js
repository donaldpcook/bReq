(function(w){var xhr,error,type="html",errors=[],getOb=function(){if(w.XMLHttpRequest)return new XMLHttpRequest;if(w.ActiveXObject)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(a){return!1}},setMethod=function(a){var b="GET";a&&typeof a=="string"&&(b=a.toUpperCase());return b},setHeader=function(a){a==="POST"&&xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded")},success=function(a){return a},parseRes=function(){var r=xhr.responseText,res;type==="json"?res=w.JSON?window.JSON.parse(r):eval("("+r+")"):res=r,success(res)},stateChanged=function(){if(xhr.readyState===4)if(xhr.status===200)parseRes();else{errors.push("Error:"+xhr.status);if(error)error();else return!1}},init=function(a,b){typeof a=="object"&&(b=a),b=b||{};var c=b.data,d;type=b.type,typeof b.success=="function"&&(success=b.success),xhr=getOb();if(!xhr){errors.push("Failed");if(error)error();else return!1}d=setMethod(b.method),xhr.onreadystatechange=stateChanged,d==="GET"&&c&&(a=a+"?"+c),xhr.open(d,a),setHeader(d),xhr.send(c);return xhr};w.bReq=init})(this)
